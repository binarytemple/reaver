/*! Arch.js v0.5b | (c) 2013 John Newman | License: http://opensource.org/licenses/MIT */
(function(n){function d(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)}function r(){}var k=n.jQuery?n.jQuery:null,l=0,p=0,g={},b=/\s+/g,a=/\'|\"|\;/g,s=/\/\/.*($|\r\n|\r|\n)|\/\*(.|\r|\n)*?\*\//g,c=/^function\([^\)]*\)\{((\'|\")usestrict(\'|\")\;?)?/i,f=/^((\'|\")\@\@[^\'\"]+(\'|\")\;?)?.*$/,e=/^\@\@/,w=/^(true|false|null|undefined|\-?(?:[1-9]\d*|0)?(?:\.\d+)?)$/,q,y,u,h,t;if(!k&&n.window)throw Error("Arch requires jQuery. No jQuery found.");k&&(q=n.Arch={});q.resolveWatchCmd=function(h){if("function"!==typeof h)return[];h=h.toString().replace(s,"").replace(b,"").replace(c,"").replace(f,"$1").replace(a,"").replace(e,"").split(",");return 1===h.length&&""===h[0]?[]:h};q.ownsProp=function(a,h){var b;if("string"===typeof h)b=Object.prototype.hasOwnProperty.call(a,h);else a:{b=h.length;var e;for(e=0;e<b;e+=1)if(!Object.prototype.hasOwnProperty.call(a,h[e])){b=!1;break a}b=!0}return b};q.version=function(){return"0.5b"};q.alias=function(a){n[a]=q};q.alias("A");q.uid=function(){var a=(l+=1)+"";99999999<l&&(p+=1,l=0,a="0");if(99999999<p)throw Error("Arch ID Error: Something is wrong.  Your application has generated more than 9 quadrillion, 999 trillion, 999 billion, 800 million unique IDs.");a="Arch-"+("00000000".slice(0,8-a.length)+a);return a=a+"-"+("00000000".slice(0,8-(p+"").length)+p)};q.guid=function(){var a=/[xy]/g,h="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a,d),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a,d),a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a,d),e=h.length,q="",c,f;for(f=0;f<e;f+=1)c=Math.random(),q=0.3>=c?q+h[f]:0.7<=c?q+b[f]:q+a[f];return q};q.parseParsable=function(a){if("string"!==typeof a)return a;if(w.test(a)||"{"===a[0]||"["===a[1])try{return JSON.parse(a)}catch(h){}return a};q._checkAdminKey=function(a,h,b){var e=/\|/;if(a!==q.adminKey)throw Error("The | function expects to be called with the Arch.adminKey singleton.".replace(e,"_checkAdminKey"));if(h!==a)throw Error("The | function expects to be called with the Arch.adminKey singleton.".replace(e,b||"<anonymous>"));return!0};q.adminKey=new r;q.atoms={":routes":new r,":stores":new r};q.system={};y=q.uid();u=q.uid();h=q.uid();q._getPropsID=function(a){if(q._checkAdminKey(q.adminKey,a,"_getPropsID"))return y};q._getReceiveID=function(a){if(q._checkAdminKey(q.adminKey,a,"_getReceiveID"))return u};q._getSystemID=function(a){if(q._checkAdminKey(q.adminKey,a,"_getSystemID"))return h};t=q.uid();q._getFallbackName=function(a){if(q._checkAdminKey(q.adminKey,a,"_getFallbackName"))return t};q._adminClosure=function(a,h,b){if(q._checkAdminKey(q.adminKey,a,"_adminClosure"))return function(a){if(q._checkAdminKey(q.adminKey,a,b))return h}};q.config=function(a){for(var h in a)q.ownsProp(a,h)&&(g[h]=a[h])};q._getConfig=function(a,h){if(q._checkAdminKey(q.adminKey,a,"_getConfig"))return g[h]}})(this);(function(n){function d(h){return typeof h===a&&!(0<h)&&!(0>h)&&0!==h}function r(a){a=Object.prototype.toString.call(a).slice(8);return a.slice(0,a.length-1).toLowerCase()}function k(e){var f=typeof e;if(e instanceof n.jQuery)return B;if(f===w||f===h||f===s||f===b||f===g)return f;if(f===a)return d(e)?u:f;if(null===e)return q;f=r(e);if(f!==c)return G.test(f)?z:D.test(f)?y:f;f=e.length;if(typeof e.length===a&&(p.ownsProp(e,"length")&&delete e.length,typeof e.length===a))return y;void 0!==f&&(e.length=f);return C&&typeof e.callee===b?t:c}function l(a,h){throw Error("Can not coerce <"+a+"> to <"+h+">.");}var p=n.Arch,g="xml",b="function",a="number",s="string",c="object",f="array",e="nodelist",w="undefined",q="null",y="list",u="nan",h="boolean",t="arguments",z="element",B="$object",D=RegExp(/list/i),G=RegExp(/^html[^\s]+element$/i),C;C=function(){return r(arguments)}()===c;k.isFalsy=function(a){var h=d(a),b,e,f;if(""===a||0===a||null===a||void 0===a||!1===a||h){if(1<arguments.length)for(b=Array.prototype.slice.call(arguments,1),e=b.length,f=0;f<e;f+=1)if(b[f]===a||h&&d(b[f]))return!1;return!0}return!1};k.isTruthy=function(){return!this.isFalsy.apply(this,Array.prototype.slice.call(arguments))};k.isNaN=function(a){return d(a)};k.isBoolean=function(a){return!0===a||!1===a};k.isXML=function(a){return typeof a===g};k.isFunction=function(a){return typeof a===b};k.isNumber=function(h){return k(h)===a};k.isString=function(a){return k(a)===s};k.isObject=function(a){return k(a)===c};k.isArray=function(a){return k(a)===f};k.isNodeList=function(a){return k(a)===e};k.isRegExp=function(a){return"regexp"===k(a)};k.isDate=function(a){return"date"===k(a)};k.isUndefined=function(a){return k(a)===w};k.isNull=function(a){return k(a)===q};k.isList=function(a){return k(a)===y};k.isArguments=function(a){return k(a)===t};k.isElement=function(a){return k(a)===z};k.is$object=function(a){return k(a)===B};k.isCollShape=function(a){return a===c||a===f||a===e||a===y||a===t||a===B};k.isCollection=function(a){return k.isCollShape(k(a))};k.isOrderedShape=function(a){return a===f||a===e||a===y||a===t||a===B};k.isOrdered=function(a){return k.isOrderedShape(k(a))};k.isInteger=function(h){return typeof h===a&&n.Math.floor(h)===h&&Infinity!==a};k.isFloat=function(h){return typeof h===a&&n.Math.floor(h)!==h&&Infinity!==a&&!d(h)};k.isEven=function(a){return 0===a%2};k.isOdd=function(a){return!k.isEven(a)};k.isMultipleOf=function(a,h){return k.isInteger(a/h)};k.isBetweenNums=function(a,h,b){return h===b?!1:h<b?a>h&&a<b:a>b&&a<h};k.isChar=function(a){return typeof a===s&&1===a.length};k.isPrototyped=function(a){for(var h in a)if(!p.ownsProp(a,h))return!0;return!1};k.isEmpty=function(){function a(h){var b=typeof h===c,q=k(h),w=0,m;if(b)if(q!==f&&q!==e&&q!==y&&q!==t&&q!==B)for(m in h){if(p.ownsProp(h,m)){w+=1;break}}else for(m=0;m<h.length;){w+=1;break}return{type:q,empty:0===w}}function h(b){return a(b).empty}h[c]=function(h){h=a(h);return h.type===c&&h.empty};h[f]=function(h){h=a(h);return h.type===f&&h.empty};h.nodeList=function(h){h=a(h);return h.type===e&&h.empty};h[y]=function(h){h=a(h);return h.type===y&&h.empty};h[B]=function(h){h=a(h);return h.type===B&&h.empty};return h}();k.coerce=function(a,h){switch(h){case "number":var b;try{b=n.parseFloat(a)}catch(e){b=l(a,"number")}return b;case "string":var f;try{f=String(a)}catch(q){f=l(a,"string")}return f;case "array":var c;var w;try{w=JSON.parse(a),c=k.isArray(w)?w:[a]}catch(g){c=l(a,"array")}return c;case "boolean":return b=/true|1/,b=/^\s*(true|false|0|1)\s*$/i.test(a)?b.test(a)?!0:!1:l(a,"boolean"),b;case "object":var s;var t;try{t=JSON.parse(a),s=k.isObject(t)?t:l(a,"object")}catch(d){s=l(a,"object")}return s;default:return l(a,h)}};p.shape=p.shape||k})(this);(function(n){function d(b,a){var s,c=b.length,f,e=[];for(s=0;s<c&&(f=a.call(this,b[s],s),f!==p);s+=1)f!==g&&Array.prototype.push.call(e,f);return e}function r(b,a){var s,c,f={};for(s in b)if(l.ownsProp(b,s))if(c=a.call(this,b[s],s),c===p)break;else c!==g&&(f[c[0]]=c[1]);return f}function k(b,a){var s,c,f=[];for(s in b)if(l.ownsProp(b,s))if(c=a.call(this,b[s],s),c===p)break;else c!==g&&Array.prototype.push.call(f,c);return f}var l=n.Arch,p={},g={};l.compAny=function(b,a){return l.shape.isOrdered(b)?d.call(this,b,a):k.call(this,b,a)};l.listify=k;l.objectify=function(b,a){var s,c=b.length,f,e={};for(s=0;s<c&&(f=a.call(this,b[s],s),f!==p);s+=1)f!==g&&(e[f[0]]=f[1]);return e};l.compArr=d;l.compObj=r;l.loops={skip:function(){return g},kill:function(){return p}};l.shallowCopy=function(b,a){return l.shape.isOrdered(b)?d.call(this,b,function(b){return a?a.call(this,b):b}):r.call(this,b,function(b,c){return[c,a?a.call(this,b):b]})};l.deepCopy=function(b){return l.shape.isOrdered(b)?d.call(this,b,function(a){return"object"!==typeof a?a:l.deepCopy(a)}):r.call(this,b,function(a,b){return[b,"object"!==typeof a?a:l.deepCopy(a)]})};l.mergeObjects=function(b,a){var g=l.shallowCopy(b);k(a,function(a,b){g[b]=a});return g};l.objectsEqual=function(b,a){var g=l.shape(b),c=l.shape(a),f="object"===g?Object.keys(b).sort():null,e="object"===c?Object.keys(a).sort():null,w="object"===g?f.length:b.length,q="object"===c?e.length:a.length,d=!0;if(g!==c||w!==q)return!1;"object"===g&&l.compArr(f,function(a,h){if(e[h]!==a)return d=!1,p});if(!d)return d;l["object"===g?"compObj":"compArr"](b,function(b,h){return"object"===typeof b?(d=l.objectsEqual(b,a[h]))?[]:p:b!==a[h]?(d=!1,p):[]});return d}})(this);(function(n){function d(a,b){l.listify(a,function(a,f){l.ownsProp(b,f)||(b[f]=a)});return b}function r(){function a(a){for(var b in a)l.ownsProp(a,b)&&(this[b]=a[b])}l.listify(g,function(b,c){a[c]=b});return a}function k(a,b){var c=d(a.prototype,b),f=r();f.parentClass=a;f.prototype=c;f._addMethod=function(b,f,q){if(l._checkAdminKey(p,b,a.name+"._addMethod")){if(l.ownsProp(c,f))throw Error("The <"+f+"> method already exists on ArchObject "+a.name+".");c[f]=q}};return f}var l=n.Arch,p=l.adminKey,g,b;g={extend:function(a){return k(this,a||{})},create:function(a){return new this(a)}};b={get:function(a){return this[a]},set:function(a,b){return this[a]=b},use:function(a,b,c){return a.prototype[b].apply(this,c||[])}};l.Object=r();l.Object.prototype=b;l.Object.getConstructorMethods=function(){return g};l.Object.getBasePrototype=function(){return b}})(this);(function(n){function d(){return function(a){return a}}function r(b){var f=!1;a.compArr(b.reactTo,function(b){if(b instanceof g&&0<e[b.settings.id])return f=!0,a.loops.kill()});return f}function k(b){b.willReactTo=a.compArr(b.willReactTo,function(e){var c=f[e];return c instanceof g?(c.watchedBy.push(b),b.reactTo=a.compArr(b.reactTo,function(a){return a===c.settings.id?c:a}),a.loops.skip()):e})}function l(b){var e=!0;a.compArr(b.reactTo,function(b){if(!b||b&&("string"===typeof b||!b.ready))return e=!1,a.loops.kill()});return e}function p(b,e){b.settings.reactTo._translateReactors&&(e instanceof g?e=e.val():a.shape.isOrdered(e)&&(e=a.compArr(e,function(a){return a instanceof g?a.val():a})));return e}function g(b){var q=this;this.ready=!1;this.queue=[];this.settings=b;this.willReactTo=[];this.reactTo=a.compArr(b.reactTo,function(a){a instanceof g||(q.willReactTo.push(a),c[a]=c[a]||[],c[a].push(q));return a});this.valsOverTime=[];this.currentCache=void 0;this.watchedBy=[];a.compArr(this.reactTo,function(a){a instanceof g&&a.watchedBy.push(q)});f[b.id]=this;e[b.id]=0;a.ownsProp(c,b.id)&&a.compAny(c[b.id],function(a){a.react()})}function b(b){b.id||(b.id=a.uid());b.reactTo||(b.reactTo=[]);"[object Array]"!==Object.prototype.toString.call(b.reactTo)&&(b.reactTo=[b.reactTo]);b.calc||(b.calc=d());return!0===b.wait?(delete b.wait,(new g(b)).prepare()):a.ownsProp(b,"initVal")?(new g(b)).react(b.initVal):(new g(b)).react()}var a=n.Arch,s=a.adminKey,c={},f={},e={};g.prototype.val=function(){return this.valsOverTime[0]||this.currentCache};g.prototype.currentVal=function(){return this.currentCache};g.prototype.clone=function(a){return b({id:a,calc:this.settings.calc,initVal:this.settings.initVal,reactTo:this.settings.reactTo})};g.prototype.destroy=function(){var b=this;this.willReactTo=this.queue=this.ready=null;a.compArr(this.reactTo,function(e){e instanceof g&&(e.watchedBy=a.compArr(e.watchedBy,function(e){return e===b?a.loops.skip():e}))});this.reactTo=null;a.compArr(this.watchedBy,function(e){e instanceof g&&(e.reactTo=a.compArr(e.reactTo,function(e){return e===b?a.loops.skip():e}))});this.currentCache=this.valsOverTime=this.watchedBy=null;delete f[this.settings.id];delete c[this.settings.id];this.settings=null};g.prototype.prepare=function(){this.ready||(k(this),this.willReactTo.length?this.ready=!1:l(this)?this.ready=!0:this.ready=!1);return this};g.prototype.react=function(b){var f=this,c;this.prepare();if(!r(this)){if(this.ready){this.queue.length&&(c=this.queue.slice(),this.queue=[],a.compArr(c,function(a){f.react(a)}));if(arguments.length)c=1===arguments.length?this.settings.calc(b):this.settings.calc.apply(null,Array.prototype.slice.call(arguments));else if(c=a.compArr(this.reactTo,function(a){if(null===a.ready)throw Error("Reactor <"+f.settings.id+"> depends on a previously destroyed Reactor.");return p(f,a.val())}),!c.length&&a.ownsProp(this.settings,"initVal")?(c=this.settings.calc.call(null,this.settings.initVal),this.settings.initVal=null):c=this.settings.calc.apply(null,c),null===this.ready)return;this.watchedBy.length?(this.valsOverTime.push(c),this.currentCache=c):(this.currentCache=c,this.valsOverTime=[]);a.compArr(this.reactTo,function(a){a.valsOverTime=a.valsOverTime.slice(1)});a.compArr(this.watchedBy,function(a){e[a.settings.id]+=1});a.compArr(this.watchedBy,function(a){e[a.settings.id]-=1;a.react()})}else a.last(this.queue)!==b&&this.queue.push(b);return this}};a.reactor=b;a._addReactorMethod=function(b,e,f){a._checkAdminKey(s,b,"_addReactorMethod")&&(g.prototype[e]=f)};a.isReactor=function(a){return a instanceof g};a.reactSync=function(){var b=Array.prototype.slice.call(arguments||[]),b=a.compArr(b,function(a){var b=a[0];"string"===typeof b&&(b=f[b]);e[b.settings.id]+=1;return 2===a.length?[b,a[1]]:[b]});a.compArr(b,function(a){var b=a[0],f=a[1];e[b.settings.id]-=1;2===a.length?b.react(f):b.react()})};a._findReactorID=function(b,e){if(a._checkAdminKey(s,b,"_findReactorID"))return f[e]};a._accessReactors=function(b){if(a._checkAdminKey(s,b,"_accessReactors"))return f}})(this);(function(n){function d(b){var a=0,g=b.fail,c=b.always,f=b.done,e,d;b.done=function(a,c,g){e=!0;"function"===typeof f&&f.call(b.context||this,a,c,g)};b.fail=function(f,c,k){a+=1;a===b.tries?(e=!0,"function"===typeof g&&g.call(b.context||this,f,c,k)):(d=p.ajax(b),d.done(b.done),d.fail(b.fail),d.always(b.always))};b.always=function(a,f){e&&"function"===typeof c&&c.call(b.context||this,a,f)};return b}function r(b,a,g){return{data:b,textStatus:a,jqXHR:g}}function k(b,a,g){return{jqXHR:b,textStatus:a,errorThrown:g}}function l(b,a){return{jqXHR:b,textStatus:a}}var p=n.jQuery,g=n.Arch;g.ajax=g.ajax||function(b){var a;if(!1===b.async)throw Error("<async> parameter was set to <false>. Arch.ajax does not allow synchronous requests.");1!==b.tries&&(b.tries=b.tries||10,b=d(b));a=p.ajax(b);b.done&&a.done(b.done);b.fail&&a.fail(b.fail);b.always&&a.always(b.always)};g.reactiveAjax=g.reactiveAjax||function(b){var a=b.reactTo||[],d=!0===b.wait?!0:!1,c=g.uid(),f={done:g.reactor({id:c+"/reactiveajax/done",wait:!0}),fail:g.reactor({id:c+"/reactiveajax/fail",wait:!0}),always:g.reactor({id:c+"/reactiveajax/always",wait:!0})},e={done:b.done?b.done:r,fail:b.fail?b.fail:k,always:b.always?b.always:l},w,q,p;delete b.reactTo;delete b.wait;b.done=w=function(a,b,c){return f.done.react(e.done(a,b,c))};b.fail=q=function(a,b,c){return f.fail.react(e.fail(a,b,c))};b.always=p=function(a,b){return f.always.react(e.always(a,b))};f.init=g.reactor({id:c+"/reactiveajax/init",reactTo:a,wait:!0,calc:function(a){a=a||b;a.done=w;a.fail=q;a.always=p;delete a.wait;delete a.reactTo;return g.ajax(a)}});d||f.init.react(b);return f};g.destroyReactiveAjax=g.destroyReactiveAjax||function(b){g.listify(b,function(a){a.destroy()})}})(this);(function(n){n=n.Arch;n.animate=n.animate||function(d,r,k){var l=k.complete,p=d.length,g=0;!0===k.wait&&(k.complete=function(){g+=1;g===p&&"function"===typeof l&&l.call(d)});return d.animate(r||{},k||{})}})(this);(function(n){var d=n.Arch,r=function(){},k="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd table time timeEnd timeStamp trace warn".split(" "),l=k.length,p=d._getConfig(d.adminKey,"disableCustomTags");for(n.console=n.console||{};l-=1;)n.console[k[l]]=n.console[k[l]]||r;String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.trimLeft=String.prototype.trimLeft||function(){return this.replace(/^\s+/,"")};String.prototype.trimRight=String.prototype.trimRight||function(){return this.replace(/\s+$/,"")};Function.prototype.bind=Function.prototype.bind||function(g){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be boundis not callable");var b=Array.prototype.slice.call(arguments,1),a=this,d=function(){},c=function(){return a.apply(this instanceof d&&g?this:g,b.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;c.prototype=new d;return c};Object.create=Object.create||function(){function g(){}return function(b){if(1!==arguments.length)throw Error("Object.create implementation only accepts one parameter.");g.prototype=b;return new g}}();Object.keys=Object.keys||function(){var g=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),a="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),d=a.length;return function(c){if("object"!==typeof c&&("function"!==typeof c||null===c))throw new TypeError("Object.keys called on non-object");var f=[],e;for(e in c)g.call(c,e)&&f.push(e);if(b)for(e=0;e<d;e++)g.call(c,a[e])&&f.push(a[e]);return f}}();Array.isArray=Array.isArray||function(g){return"[object Array]"===Object.prototype.toString.call(g)};Array.prototype.indexOf=Array.prototype.indexOf||function(g){if(null==this)throw new TypeError;var b,a=Object(this),d=a.length>>>0;if(0===d)return-1;b=0;1<arguments.length&&(b=Number(arguments[1]),b!=b?b=0:0!=b&&Infinity!=b&&-Infinity!=b&&(b=(0<b||-1)*Math.floor(Math.abs(b))));if(b>=d)return-1;for(b=0<=b?b:Math.max(d-Math.abs(b),0);b<d;b++)if(b in a&&a[b]===g)return b;return-1};Array.prototype.lastIndexOf=Array.prototype.lastIndexOf||function(g){if(null==this)throw new TypeError;var b,a=Object(this),d=a.length>>>0;if(0===d)return-1;b=d;1<arguments.length&&(b=Number(arguments[1]),b!=b?b=0:0!=b&&b!=1/0&&b!=-(1/0)&&(b=(0<b||-1)*Math.floor(Math.abs(b))));for(b=0<=b?Math.min(b,d-1):d-Math.abs(b);0<=b;b--)if(b in a&&a[b]===g)return b;return-1};Array.prototype.forEach=Array.prototype.forEach||function(g,b){var a,d;if(null==this)throw new TypeError("this is null or not defined");var c,f=Object(this),e=f.length>>>0;if("[object Function]"!=={}.toString.call(g))throw new TypeError(g+" is not a function");2<=arguments.length&&(a=b);for(d=0;d<e;)d in f&&(c=f[d],g.call(a,c,d,f)),d++};Array.prototype.every=Array.prototype.every||function(g,b){var a,d,c;if(null==this)throw new TypeError;a=Object(this);d=a.length>>>0;if("function"!==typeof g)throw new TypeError;for(c=0;c<d;c++)if(c in a&&!g.call(b,a[c],c,a))return!1;return!0};Array.prototype.some=Array.prototype.some||function(g,b){if(null==this)throw new TypeError;var a,d=Object(this),c=d.length>>>0;if("function"!==typeof g)throw new TypeError;for(a=0;a<c;a++)if(a in d&&g.call(b,d[a],a,d))return!0;return!1};Array.prototype.filter=Array.prototype.filter||function(g,b){if(!this)throw new TypeError;var a=Object(this);if("function"!==typeof g)throw new TypeError;var d=[],c;for(c in a)a.hasOwnProperty(c)&&g.call(b,a[c],c,a)&&d.push(a[c]);return d};Array.prototype.map=Array.prototype.map||function(g,b){var a,d,c;if(null==this)throw new TypeError(" this is null or not defined");var f=Object(this),e=f.length>>>0;if("function"!==typeof g)throw new TypeError(g+" is not a function");b&&(a=b);d=Array(e);for(c=0;c<e;){var k;c in f&&(k=f[c],k=g.call(a,k,c,f),d[c]=k);c++}return d};Array.prototype.reduce=Array.prototype.reduce||function(g,b){if(null===this||"undefined"===typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof g)throw new TypeError(g+" is not a function");var a,d,c=this.length>>>0,f=!1;1<arguments.length&&(d=b,f=!0);for(a=0;c>a;++a)this.hasOwnProperty(a)&&(f?d=g(d,this[a],a,this):(d=this[a],f=!0));if(!f)throw new TypeError("Reduce of empty array with no initial value");return d};Array.prototype.reduceRight=Array.prototype.reduceRight||function(d,b){if(null===this||"undefined"===typeof this)throw new TypeError("Array.prototype.reduceRight called on null or undefined");if("function"!==typeof d)throw new TypeError(d+" is not a function");var a,k;a=this.length>>>0;var c=!1;1<arguments.length&&(k=b,c=!0);for(a-=1;-1<a;--a)this.hasOwnProperty(a)||(c?k=d(k,this[a],a,this):(k=this[a],c=!0));if(!c)throw new TypeError("Reduce of empty array with no initial value");return k};d.newTag=function(d){d=document.createTextNode('\x3c!--[if lt IE 9]><script>document.createElement("'+d+'");\x3c/script><![endif]--\x3e');document.head.appendChild(d)};d.newTag("archlet");d.newTag("template");!0!==p&&(d.newTag("bind"),d.newTag("bindlist"))})(this);(function(n){var d=n.Arch;d.first=function(d){return d[0]};d.rest=function(d){return"string"===typeof d?d.slice(1):Array.prototype.slice.call(d,1)};d.lead=function(d){return"string"===typeof d?d.slice(0,d.length-1):Array.prototype.slice.call(d,0,d.length-1)};d.last=function(d){return d[d.length-1]};d.shove=function(d,k){d.push(k);return d};d.findProperty=function(n,k,l){var p=[],g=2<arguments.length;n.forEach(function(b){d.ownsProp(b,k)&&(g?b[k]===l&&p.push(b):p.push(b))});return p}})(this);(function(n){var d=n.Arch,r=d.adminKey,k=d._getPropsID(r);d._getReceiveID(r);d._createModulePrototype=function(l,p,g,b,a,n,c,f,e){function w(a,b){return d.shallowCopy(b,function(b){return b.bind(a)})}function q(a){d.isReactor(a)?a.destroy():d.compAny(a,function(a){a.destroy()})}function y(h,f,c,g){var q=a(h,this),k=q.moduleRef,l=q.val(),w;if(!d.shape.isArray(l)||!d.shape.isArray(f))throw Error("<"+c+"> only allows you to add lists to lists.");l=l.slice();q.isSeries?(w=!0,f=d.compArr(f,function(a){var b=d.uid();return e(h,k,a,b)})):f=d.compArr(f,function(a,e){return b(h+"."+d.uid(),[],a,k,!1,!0)});l[c].apply(l,f);q.react(l);w&&d.compArr(f,function(a){d.listify(a,function(a){a.react()})});q.manipulations[g].react(f);return l.length}function u(a,b,e){var f=n[this.appName].appStores,c=this.appName+"/:stores/"+a;return!0===f[a].isAjax?f[a].attach({type:b,data:e}):d.sendWS(c,{method:b,path:f[a].path,content:e})}if(d._checkAdminKey(r,l,"_createModulePrototype"))return{_execute:function(a){if(d._checkAdminKey(r,a,"Module#_execute"))return c(this)},_isModule:function(a){if(d._checkAdminKey(r,a,"Module#_isModule"))return!0},get:function(a){return p(a,this)},set:function(a,b){return g(a,b,this)},setSync:function(){var a=Array.prototype.slice.call(arguments||[]),b=this;return d.reactSync.apply(this,d.compArr(a,function(a){return[k+"."+b.name+"."+a[0],a[1]]}))},PUT:function(a,b){return u.call(this,a,"PUT",b)},POST:function(a,b){return u.call(this,a,"POST",b)},DELETE:function(a,b){return u.call(this,a,"DELETE",b)},call:function(b,e){var f;if(f=a(b,this))return f=e?f.react.apply(f,e||[]):f.react(),f.val()},require:function(a){a=":"===a.charAt(0)?n[this.appName].specialMods[a]:n[this.appName].namedMods[a];c(a);return w(this,a.exports)},initAll:function(b){b=a(b,this).val();d.reactSync.apply(null,d.compAny(b,function(a){return[a]}))},toObject:function(b){b=a(b,this).val();return d.compObj(b,function(a,b){return d.isReactor(a)?[b,a.val()]:[b,a]})},toArray:function(b){b=a(b,this).val();return d.compArr(b,function(a){return d.isReactor(a)?a.val():"object"===d.shape(a)?d.compObj(a,function(a,b){return[b,d.isReactor(a)?a.val():a]}):a})},toJSON:function(b){var e=a(b,this).val(),f=d.shape(e),c=d.shape.isCollShape(f),f=d.shape.isOrderedShape(f);return c?JSON.stringify(f?this.toArray(b):this.toObject(b)):String(e)},count:function(b){return a(b,this).val().length},first:function(b){b=a(b,this).val();return d.first(b).val()},rest:function(b){b=a(b,this).val();return d.compArr(d.rest(b),function(a){return a.val()})},last:function(b){b=a(b,this).val();return d.last(b).val()},lead:function(b){b=a(b,this).val();return d.compArr(d.lead(b),function(a){return a.val()})},empty:function(b){b=a(b,this);var e=b.val();b.react([]);b.manipulations.redraw.react([]);d.compArr(e,function(a){q(a)})},push:function(a){var b=Array.prototype.slice.call(arguments||[],1);return y.call(this,a,b,"push","addBack")},replace:function(a,b){this.empty(a);return this.push(a,b)},pop:function(b){b=a(b,this);var e=b.val(),f=d.lead(e),e=d.last(e);b.react(f);b.manipulations.rmBack.react([e]);q(e);return f.length},reverse:function(b){b=a(b,this);var e=b.val();e.reverse();b.react(e);b.manipulations.redraw.react(e)},shift:function(b){b=a(b,this);var e=b.val(),f=d.rest(e),e=d.first(e);b.react(f);b.manipulations.rmFront.react([e]);q(e);return f.length},unshift:function(a){var b=Array.prototype.slice.call(arguments||[],1);return y.call(this,a,b,"unshift","addFront")},sort:function(b,e){var f=a(b,this),c=f.val();c.sort(e?function(a,b){return e.call(vals,a.val(),b.val())}:function(a,b){return String(a.val()).localeCompare(String(b.val()))});f.react(c);f.maniplulations.redraw.react(c)},splice:function(e,f,c,g){var k=a(e,this),l=k.moduleRef,w=k.val(),p=w.slice(0,f),n=w.slice(f,f+c);f=w.slice(f+c);(g||[]).forEach(function(a){p.push(b(e+"."+d.uid(),[],a,l,!1,!0))});p.push.apply(p,f);k.react(p);k.manipulations.redraw.react(p);n.forEach(function(a){q(a)});return p.length},findUniqueValue:function(b,e,f){b=a(b,this).val();var c;d.compArr(b,function(a,b){d.isReactor(a);var h;if(d.ownsProp(a,e)&&(h=d.isReactor(a[e])?a[e].val():a[e],h===f))return c=b,d.loops.kill()});return"number"===typeof c?c:-1},removeUniqueValue:function(b,e,f){var c=a(b,this),d=c.val(),c=c.moduleRef;e=this.findUniqueValue.call(c,b,e,f);return-1<e?this.splice.call(c,b,e,1):d.length}}}})(this);(function(n){n=Arch.adminKey;var d=Arch._getConfig(n,"disableCustomTags");Arch._defaultHooks=Arch._adminClosure(n,function(n){if(!0!==d)return n.replace(/\<\s*bind\s+to\=(\'|\")([^\'\"]+)(\'|\")\s*\/?\s*\>/ig,'<span data-bind="content: $2"></span>').replace(/\<\s*\/\s*bind\s*\>/ig,"").replace(/\{\{([^\}]+)\}\}/g,'<span data-bind="content: $1"></span>')},"_defaultHooks")})();(function(n){function d(b){a[b]=a[b]||{templates:{},regHooks:[]}}function r(a,b){var e=b.getAttribute(a);p.registerTemplate(e,b.innerHTML);l(b).remove()}function k(){var a=l('script[type="text/arch-template"]'),b=l("template");p.compArr(a,function(a){r("role",a)});p.compArr(b,function(a){r("role",a)});l("archlet").html("");p.system.templatesReady.react(!0)}var l=n.jQuery,p=n.Arch,g=p.adminKey,b=p._getFallbackName(g);p._getConfig(g,"disableCustomTags");var a={},s;p.system.templatesReady=p.reactor({id:p._getSystemID(g)+"._system/templatesready",wait:!0});p.system.execRoutes=p.reactor({id:p._getSystemID(g)+"._system/execroutes",wait:!0});s=p.Object.extend({});p._accessTemplates=function(c,f){if(p._checkAdminKey(g,c,"_getTemplates"))return f&&d(f),p.shallowCopy(f?a[f].templates:a[b].templates)};p._templateSource=function(c,f){var e=f.replace(/\s+/g," ").trim().split(" ");1===e.length&&e.unshift(b);if(p._checkAdminKey(g,c,"_templateSource"))return a[e[0]].templates[e[1]].content+""};p._addRegHook=function(c,f,e){2===arguments.length&&(e=f,f=b);p._checkAdminKey(g,c,"_addRegHook")&&a[f].regHooks.push(e)};p.registerTemplate=function(c,f){var e=c.replace(/\s+/g," ").trim().split(" ");1===e.length&&e.unshift(b);d(e[0]);if(p.ownsProp(a[e[0]].templates,e[1]))throw Error("A template called "+e[1]+" already exists in this app.");p.compArr(a[e[0]].regHooks,function(a){f=a(f)});return a[e[0]].templates[e[1]]=s.create({name:e[1],content:f})};l(function(){k()})})(this);(function(n){function d(a){var b=!1,c=[],c=this.window.location.href.replace(/\#.*$/,"");a=(a+"").replace("\\","/");-1!==a.indexOf("://")&&(b=!0);b||(a=c.substring(0,c.lastIndexOf("/")+1)+a);c=a.split("/");a=[];for(b=0;b<c.length;b+=1)"."!==c[b]&&(".."===c[b]?3<a.length&&a.pop():(2>a.length||""!==c[b])&&a.push(c[b]));return a.join("/")}function r(a,b){var c=this,d={":recurse":!0,url:c.url,data:b||void 0,type:a||"GET",timeout:3E4,done:function(a){return c.reactors.message.react({data:a})},fail:function(a,f,d){return c.reactors.error.react({data:b})},always:function(){return d[":recurse"]?l.ajax(d):!0}};return d}function k(a,b,c){var d=s[a];c=c||0;if(!0===d.isClosed)n.console.log("Arch Note: WebSocket closed before data could be sent.");else{if(1E3<c)throw Error("Could not connect to <"+d.url+">.");return 1!==d.readyState?setTimeout(function(){l.sendWS(a,b,c+1)},10):d.send(JSON.stringify(b))}}var l=n.Arch,p=n.WebSocket||null,g=/^http/i,b=/^ws(s)?\:(\/\/)?/i,a=/^[^\:\/]+\:\d+/,s={},c;!p&&(WebSocket=function(f){var e;var c=f,d;if(g.test(c))e=c;else{protocol=c.match(b);if(!protocol)throw Error("Unable to resolve websocket URL to Http.");"s"===protocol[1]?protocol="https://":protocol="http://";c=c.replace(b,"");(d=c.match(a))&&(d=d[0].split(":"));e=d?d[0]:"";d=d?d[1]:"";c=c.replace(a,"");"https://"===protocol&&"443"!==d||"http://"===protocol&&"80"!==d?d&&(d=":"+d):d&&(d="");e=protocol+e+d+c}this.URL=this.url=e;this.extensions=this.bufferedAmount=this.binaryType="N/A";this.onopen=this.onmessage=this.onerror=this.onclose=void 0;this.protocol="N/A";this.readyState=1;this.origURL=f;this.ajax=void 0});WebSocket.prototype.send=WebSocket.prototype.send||function(a){a=r.call(this,"POST",a);this.ajax&&(this.ajax.settings[":recurse"]=!1);this.ajax={settings:a,ajax:l.ajax(a)}};c=WebSocket.prototype.close||function(a,b){this.ajax&&(this.ajax.settings[":recurse"]=!1);this.reactors.close.react(a,b)};WebSocket.prototype.close=function(){var a=c.apply(this,Array.prototype.slice.call(arguments));this.isClosed=!0;return a};l.createWS=function(a,b){var c,g;c=d(b).replace(/^http(s)?/,"ws$1");g=new WebSocket(c);c=":ws."+a;if(l.ownsProp(s,a))throw Error("WebSocket <"+a+"> already exists.");s[a]=g;g.reactors={};g.reactorPrefix=c;g.reactors.open=l.reactor({id:c+".open"});g.reactors.close=l.reactor({id:c+".close"});g.reactors.message=l.reactor({id:c+".message"});g.reactors.error=l.reactor({id:c+".error"});g.onopen=function(a){g.reactors.open.react(a)};g.onclose=function(a){g.reactors.close.react(a)};g.onmessage=function(a){g.reactors.message.react(a.data)};g.onerror=function(a){g.reactors.error.react(a.data)};c=r.call(g);!p&&(this.ajax={settings:c,ajax:l.ajax(c)});return g.reactors};l.sendWS=function(a,b){return k(a,b)};l.closeWS=function(a,b,c){return s[a].close(b||1E3,c||"Manually closed by user.")};l.reopenWS=function(a){var b,c;if(!l.ownsProp(s,a))throw Error("Socket <"+a+"> was never created.");b=s[a];!0!==b.isClosed&&b.close();c=new WebSocket(b.url||b.URL);s[a]=c;c.reactorPrefix=b.reactorPrefix;c.reactors=l.compObj(b.reactors,function(a,b){return[b,a]});l.compArr(["open","close","message","error"],function(a){c["on"+a]=b["on"+a]});a=r.call(c);!p&&(this.ajax={settings:a,ajax:l.ajax(a)});return c.reactors};l._getWS=function(a,b){if(l._checkAdminKey(l.adminKey,a,"_getWS"))return s[b]}})(this);(function(n){function d(){}function r(a,b){this.fn=a;this.args=b||[]}function k(a){this.fn=a}function l(a){this.hash=a||{}}function p(a){this.list=a||[]}function g(a){this.fn=a}function b(a,b,c,e){this.connectPath=a;this.byName=b;this.modName=c;this.tempName=e;this.connection=null;this.connectionInfo={}}function a(a,b,c){this.byName=a;this.modName=b;this.tempName=c}function s(a,b){this.ajax=a;this.settings=b}function c(a){this.arr=a||[]}function f(e){m.listify(e.props,function(d,f){d instanceof r||d instanceof g||d instanceof k||d instanceof c||d instanceof b||d instanceof a||d instanceof s||d instanceof l||d instanceof p?d.gen(e,f):"function"===typeof d?v(f,m.resolveWatchCmd(d),d,e,!0):v(f,m.resolveWatchCmd(d),d,e,!1)});"RoutesModule"===e.modType&&m.listify(e.routeConfig,function(a,b){e[b].call(e,a)})}function e(a){var b;if(!a.exec){if(m.ownsProp(m.atoms,a.name))switch(a.name){case ":routes":b=m.reactor({id:m.uid()+".execmodule",reactTo:[m.system.execRoutes],calc:function(c){!0===c&&(f(a),b.destroy())}});break;case ":stores":f(a);break;default:throw Error(mod.name+" is not a recognized module.");}else f(a);a.exec=!0}}function w(a,b){return m.compArr(a,function(a){if("string"!==typeof a)throw Error("Observed data should be indicated with strings.");return a})}function q(a,b,c,e,d){a.createType=c;a.moduleRef=e;a.hashKey=b;a.isSeries=d||!1;":list"===c&&(a.manipulations={addBack:m.reactor({id:m.uid()+"/"+e.name+"/"+b+".addBack"}),addFront:m.reactor({id:m.uid()+"/"+e.name+"/"+b+".addFront"}),rmBack:m.reactor({id:m.uid()+"/"+e.name+"/"+b+".rmBack"}),rmFront:m.reactor({id:m.uid()+"/"+e.name+"/"+b+".rmFront"}),redraw:m.reactor({id:m.uid()+"/"+e.name+"/"+b+".redraw",initVal:a.val()})})}function y(a,b){var c=m.lead(a.match(F)[0]),e=a.replace(F,""),c=b[c],d=m.isReactor(c);if(F.test(e))return y(e,d?c.val():c);if(K.test(e))try{return c.manipulations[e]}catch(f){throw Error("Could not find reactor for",a,".");}return d?c.val()[e]:c[e]}function u(a,b){var c,e;return":connect"===a?b._receive(x):L.test(a)?(c=m.lead(a.match(L)[0]),e=a.replace(L,""),c=m._getModule(x,c),u(e,c)):F.test(a)?y(a,b._data(m.adminKey)):b._data(m.adminKey)[a]}function h(a,b,c){n.console.log("WARNING: Currently overwriting the <"+a.name+"/"+b+"> property.");c[b].manipulations&&m.compAny(c[b].manipulations,function(a){a.destroy()});c[b].isSeries&&m.compArr(c[b].val(),function(a){m.listify(a,function(a){a.destroy()})});c[b].destroy()}function t(a,b,c){var e=!1;a=m.compArr(a,function(a,d){return"string"!==typeof a?a.settings.id:L.test(a)?-1<a.indexOf(O)?a:propsId+"/"+a:J.test(a)?a:":connect"===a?(c.result=!0,S+"/"+b.appName+" "+b.name+".receive"):F.test(a)?(K.test(a)&&(e=!0),u(a,b).settings.id):O+"/"+b.name+"/"+a});a._translateReactors=e;return a}function z(a){return m.compObj(a,function(a,b){return[b,a.val()]})}function B(a,b,c,e){c=c.val();c.length!==e.length?(a.empty(b),a.push.call(a,b,e)):m.compArr(c,function(a,b){var c;c=z(a);m.objectsEqual(c,e[b])||m.listify(a,function(a,c){a.react(e[b][c])})})}function D(a,b,c,e){return m.compArr(a,function(a){return"string"===typeof a?O+"/"+b.name+"/"+c+"."+e+"."+a:a})}function G(a,b){var c=u(a,b);if(c){if(c.createType||!m.isReactor(c))throw Error("You do not have direct access to reactor containers.");return c.val()}}function C(a,b,c){var e;if(N.test(a))throw Error('Special tags ":hash" and ":list" are only for data creation.');e=u(a,c);if(!e)throw Error("You must create the "+a+" property before you can change it.");if(":list"===e.createType){if(!m.shape.isOrdered(b))throw Error("The "+a+" property is a :list. Please recalculate it using an array.");B(c,a,e,b);return e.val()}if(":hash"===e.createType)throw Error("Please use appropriate methods to calculate an object's inner properties.");e.react(b);return e.val()}function H(a,b,c,e){return m.compObj(c,function(c,d){var f=c instanceof k,h=f?D(m.resolveWatchCmd(c.fn),b,a,e):[],h=[d,v(a+"."+e+"."+d,h,f?c.fn:c,b,!0,!0)];(f||"function"===typeof c)&&(h[1].lazy=!0);return h})}function v(a,b,c,e,d,f){var g,k,l,F,p,J;if(L.test(a))throw Error("You can not create or destroy the data of one module from within a different module.");F=this.createType?this.createType:null;g={};k=e._data(x);l={result:!1};k[a]&&h(e,a,k);m.shape.isOrdered(b)||(b=[b]);b=w(b,e);g.reactTo=t(b,e,l);g.id=O+"/"+e.name+"/"+a;g.wait=d;if("function"===typeof c)g.calc=c.bind(e);else{if(F)switch(F){case ":hash":J=m.uid();c=H(a,e,c,J);J=!0;break;case ":list":c=m.compArr(c,function(b){return v(a+"."+m.uid(),[],b,e,!1,!0)});break;case ":series":F=":list";p=!0;c=m.compArr(c,function(b){var c=m.uid();return H(a,e,b,c)});J=!0;break;default:throw Error("<"+F+"> is not a recognized data type.");}else l.result&&(g.calc=function(a){return void 0===a?c:a}.bind(e));g.initVal=c}b=m.reactor(g);q(b,a,F,e,p);!0!==f&&(k[a]=b);J&&m.listify(g.initVal,function(a,b){m.isReactor(a)?!0!==a.lazy&&a.react():m.listify(a,function(a){a.react()})});return b}function I(a){delete a.done;delete a.fail;delete a.always;delete a.success;delete a.error;delete a.complete;return a}function P(a){var b=/\/+$/;return/^(https?|wss?)\:\/\//i.test(a)?a.replace(/(^[^\:\/]+\:\/\/)?[^\/]+/,"").replace(b,""):a.replace(/^([^\/]+)?\/+/,"/").replace(b,"")}function M(a,b,c){var e=A[a.appName].appStores,d=a.appName+"/:stores/"+b,f=P(c)||"/";m.reactor({id:":stores."+b,reactTo:[":ws."+d+".message"]});e[b]={path:f,attach:function(a){try{m.reopenWS(d)}catch(b){m.createWS(d,a||c)}m.sendWS(d,{method:"GET",path:f,content:null})},detach:function(a,b){m.closeWS(d,a,b)}}}function Q(a,b,c){a=A[a.appName].appStores;var e;I(c);c.type="GET";c.wait=!0;e=m.reactiveAjax(c);m.reactor({id:":stores."+b,reactTo:[e.done],wait:!0,calc:function(a){return a?a.data:void 0}});a[b]={isAjax:!0,detach:d,attach:function(a){return e.init.react(a||c)}}}var m=n.Arch,A={},x=m.adminKey,E=m._getFallbackName(x),N=/^\:(object|list|series)\s*/,K=/(^|\.)(rmFront|rmBack|addFront|addBack|redraw)$/,L=/^[^\/]+\//,F=/^[^\.]+\./,J=/^\:(stores|errors)\./,O=m._getPropsID(x),S=m._getReceiveID(x),R;R={namedMods:{},specialMods:{},appStores:{}};A[E]=m.deepCopy(R);r.prototype.gen=function(a,b){v(b,m.resolveWatchCmd(this.fn),this.fn,a,!0);a.call(b,this.args)};k.prototype.gen=function(a,b){v(b,m.resolveWatchCmd(this.fn),this.fn,a,!1)};l.prototype.gen=function(a,b){v.call({createType:":hash"},b,[],this.hash,a,!1)};p.prototype.gen=function(a,b){v.call({createType:":list"},b,[],this.list,a,!1)};g.prototype.gen=function(a,b){v(b,m.resolveWatchCmd(this.fn),this.fn,a,!0);a.exports[b]=this.fn};b.prototype.gen=function(a,b){var c,e;if("RoutesModule"!==a.modType)throw Error("Connections can only be created within a :routes module.");this.byName?(c=A[a.appName].namedMods[b],e=m._accessTemplates(x,c.appName)[b]):(c=A[a.appName].namedMods[this.modName],e=m._accessTemplates(x,c.appName)[this.tempName]);this.connection="string"===typeof this.path?a.connectPath.call(a,b,this.path,c,e):a.connect.call(a,b,c,e);m.listify.call(this,this.connectionInfo,function(a,b){this.connection[b].call(this.connection,a)})};b.prototype.useStore=function(a){this.connectionInfo.useStore=a;return this};b.prototype.transitionType=function(a){this.connectionInfo.transitionType=a;return this};b.prototype.enter=function(a){this.connectionInfo.enter=a;return this};b.prototype.exit=function(a){this.connectionInfo.exit=a;return this};b.prototype.preRender=function(a){this.connectionInfo.preRender=a;return this};a.prototype.gen=function(a,b){var c,e;if("RoutesModule"!==a.modType)throw Error("Archlet bindings can only be created within a :routes module.");this.byName?(c=A[a.appName].namedMods[b],e=m._accessTemplates(x,c.appName)[b]):(c=A[a.appName].namedMods[this.modName],e=m._accessTemplates(x,c.appName)[this.tempName]);a.bindArchlet.call(a,b,c,e)};s.prototype.gen=function(a,b){if("StoresModule"!==a.modType)throw Error("Stores can only be created within a :stores module.");this.ajax?Q(a,b,this.settings):M(a,b,this.settings)};c.prototype.gen=function(a,b){v.call({createType:":series"},b,[],this.arr,a,!1)};m.Module=m.Object.extend(m._createModulePrototype(x,G,C,v,u,A,e,D,H));m.RoutesModule=m.Module.extend({});m.StoresModule=m.Module.extend({});m.module=function(a,b,c){var d,f,h,g,k,l;switch((arguments||[]).length){case 3:case 2:h=a.replace(/\s+/g," ").trim().split(" ");g=1===h.length?E:h[0];k=1===h.length?h[0]:h[1];":"===k.charAt(0)&&(d=k);break;case 1:if("string"===typeof a)throw Error("Arch.module expects a function argument.");b=a;k="";break;default:throw Error("Wrong number of arguments");}switch(d){case void 0:h="Module";break;case ":routes":h="RoutesModule";break;case ":stores":h="StoresModule";break;default:throw Error(d+" is not a recognized module type.");}f=m[h].create({_data:m._adminClosure(x,{},"Module._data"),modType:h,props:"function"===typeof b?b():b,exec:!1,exports:{},name:k,appName:g,scroll:0});if(k)A[g]=A[g]||m.deepCopy(R);else return l=m.reactor({reactTo:[m._getSystemID(x)+"._system/ready"],wait:!0,calc:function(a){a&&e(f);l.destroy()}}),f;if(d){if(m.ownsProp(A[g].specialMods,d))throw Error("The "+d+" module has already been created");A[g].specialMods[k]=f;"RoutesModule"===h&&(f.routeConfig=c||{});e(f);return f}f._receive=m._adminClosure(x,m.reactor({id:S+"/"+g+" "+k+".receive"}),"Module._receive");return A[g].namedMods[k]=f};m.calc=function(a){return new k(a)};m.immediate=function(a){return new r(a)};m.expose=function(a){return new g(a)};m.series=function(a){return new c(a)};m.hash=function(a){return new l(a)};m.list=function(a){return new p(a)};m.store=function(a){return new s(!1,a)};m.ajaxStore=function(a){return new s(!0,a)};m.connect=function(a,c){return new b(null,!1,a,c)};m.connectByName=function(){return new b(null,!0,null,null)};m.connectPath=function(a,c,e){return new b(a,!1,c,e)};m.connectPathByName=function(a){return new b(a,!0,null,null)};m.bindArchlet=function(b,c){return new a(!1,b,c)};m.bindArchletByName=function(){return new a(!0,null,null)};m.attachStore=function(a,b){var c=a.trim().replace(/\s+/," ").split(" ");1===c.length&&c.unshift(E);return A[c[0]].appStores[c[1]].attach(b)};m.detachStore=function(a,b,c){a=a.trim().replace(/\s+/," ").split(" ");1===a.length&&a.unshift(E);return A[a[0]].appStores[a[1]].detach(b,c)};m.findData=function(a,b){var c;a=a.trim();(c=a.slice(0,a.indexOf("/")))&&e(m._getModule(x,c));switch(arguments.length){case 1:return G(a);case 2:return C(a,b);default:throw Error("Wrong number of arguments.");}};m.findCall=function(a,b){var c=a.slice(0,a.indexOf("/"));c&&e(m._getModule(x,c));return m.Module.prototype.call.call(null,a,b||[])};m._getModule=function(a,b){var c=b.replace(/\s+/g," ").trim().split(" "),e=1===c.length?E:c[0],c=1===c.length?c[0]:c[1];if(m._checkAdminKey(x,a,"_getModule"))return A[e].namedMods[c]};m._findReactor=function(a,b,c){if(m._checkAdminKey(x,a,"_findReactor"))return u(b,c)};m._getStores=function(a,b){var c=b||E;if(m._checkAdminKey(x,a,"_getStores"))return m.shallowCopy(A[c].appStores)}})(this);(function(n){function d(a,b){var c;if(Q.test(b)){c=x[0][E[0]];if(!c)return;if(!h.isReactor(c)||M.test(b))c=c[h.last(b.split("."))]}else P.test(b)?c=h._findReactor(t,b):M.test(b)?(c=b.split("."),c=a[c[0]].val()[c[1]]):c=a[b];if(!h.isReactor(c))throw Error("<"+b+"> is not a reactive value.");return c}function r(a,b){h.listify(D,function(b,c){0===c.indexOf(a+"/")&&delete D[c]});!0===b&&k(u("[data-arch-iter]").filter(function(){var a=this.getAttribute("data-arch-permanent");return!a||"true"!==a.toLowerCase()}));var c=[a];h.ownsProp(B,a)&&(c.push.apply(c,B[a]),delete B[a]);h.compArr(c,function(a){h.listify(z[a],function(a){a._isJQBinding&&a._isJQBinding(t)?a.$elem.off(a.action):a.destroy()});delete z[a]})}function k(a){h.compArr(a,function(a){a=a.getAttribute("data-arch-iter")+"."+a.getAttribute("data-arch-suffix");r(a)})}function l(a){var b;a=h.compArr(a.split(";"),function(a){return a?a:h.loops.skip()});return h.compArr(a,function(a){var c=a.indexOf(":"),e=a.slice(0,c);a=a.slice(c+1);return{bindingType:e.trim(),bindingVals:h.compArr(a.split(","),function(a){a=a.trim();"@each"===a&&(b=!0);return a||h.loops.skip()}),usesIter:b}})}function p(a){var b=h.compObj(a,function(a){return[a.bindingType,!0]},{});h.compArr(b,function(a,c){h.ownsProp(N,c)&&h.compArr(N[c],function(a){if(h.ownsProp(b,a))throw Error("The binding type <"+a+"> is incompatible with <"+c+">.");})})}function g(a){var b,c;if(1<a.properties.length&&"@"!==a.properties[1][0])throw Error(a.err);b=d(a.modData,a.properties[0]);c=h.uid()+"/"+a.viewName+"/"+a.properties[0];z[a.viewName][c]=h.reactor({id:c,reactTo:[b],calc:a.action})}function b(a,b,c,e,d){var f=u();B[c]=B[c]||[];h.compArr(a,function(g,k){var l=h.uid(),q=b.clone().attr("data-arch-iter",e).attr("data-arch-suffix",l),p=q.attr("data-bind"),l=e+"."+l;B[c].push(l);q.attr("data-bind",p.replace(m,""));x.unshift(a);E.unshift(k);y(l,d,q,!0,!0);f=f.add(q);x.shift();E.shift()});return f}function a(a,c,e,d,f,g){z[f][e+"/manips.addBack"]=h.reactor({id:e+"/manips.addBack",wait:!0,reactTo:[a.manipulations.addBack],calc:function(a){var h=u('[data-arch-iter="'+e+'"]').last();h.length||(h=d);h.after(b(a,c,f,e,g))}});z[f][e+"/manips.addFront"]=h.reactor({id:e+"/manips.addFront",wait:!0,reactTo:[a.manipulations.addFront],calc:function(a){d.after(b(a,c,f,e,g))}});z[f][e+"/manips.rmBack"]=h.reactor({id:e+"/manips.rmBack",wait:!0,reactTo:[a.manipulations.rmBack],calc:function(a){var b=u('[data-arch-iter="'+e+'"]');a=b.slice(b.length-a.length);a.remove();k(a)}});z[f][e+"/manips.rmFront"]=h.reactor({id:e+"/manips.rmFront",wait:!0,reactTo:[a.manipulations.rmFront],calc:function(a){a=u('[data-arch-iter="'+e+'"]').slice(0,a.length);a.remove();k(a)}});z[f][e+"/manips.redraw"]=h.reactor({id:e+"/manips.redraw",wait:!0,reactTo:[a.manipulations.redraw],calc:function(a){var h=u('[data-arch-iter="'+e+'"]');h.remove();k(h);d.after(b(a,c,f,e,g))}});a.manipulations.redraw.react(a.val())}function s(a,b,c,e){return g({err:"Node content can only be bound to one property.",modData:e,properties:b,viewName:c,action:function(c){if("@send"===b[1]){c=a.html();var f=d(e,b[0]);b.length=1;f.react(c)}else a.html(c)}})}function c(a,b,c,e,d){var f=c[1],h=c[2],m=["hide","show"];"string"===typeof h&&C.test(h)&&(h=n.parseFloat(h));if(f)switch(f){case "fade":m=["fadeOut","fadeIn"];break;case "slide":m=["slideUp","slideDown"]}return g({err:"Visibility conditions can only be bound to one property.",modData:d,properties:c.slice(0,1),viewName:e,action:function(c){var e,d;a?(e=m[0],d=m[1]):(e=m[1],d=m[0]);b[!1===c||void 0===c||null===c||""===c?e:d](h)}})}function f(a,b,c,e,f,g){var m=b[0].nodeName.toLowerCase(),k,l;A.test(m)&&(m="input"!==m&&"textarea"!==m||"value"!==a?"change":"keyup",k=h.uid(),z[f][k]=K.create({$elem:b,action:m,prev:null}),l=d(g,e),b.on(m,function(e){var d=z[f][k],g;e.preventDefault();switch(a){case "value":g=b.val();e=e.keyCode||e.which;if(g!==d.prev||13===e)d.prev=g,l.react(g);break;case "checked":c?l.react(h.parseParsable(b.val())):l.react(b[0].checked);break;case "selected":l.react(b[0].selected);break;default:l.react(l.val())}}))}function e(a,b,c,e,h){var m="input"===b[0].nodeName.toLowerCase()&&"radio"===b[0].getAttribute("type").toLowerCase();"value"!==a&&"selected"!==a&&"checked"!==a||f(a,b,m,c[0],e,h);return g({err:"Node attributes can only be bound to one property.",modData:h,properties:c,viewName:e,action:function(e){var f,g;m&&"checked"===a?b.val()===String(e)&&(b[0].checked=!0):(g=(f="value"===a)?b.val():b.attr(a),"@send"===c[1]?(e=f?b.val():b.attr(a),f=d(h,c[0]),c.length=1,f.react(e)):g!==e&&(f?b.val(e):b.attr(a,e)))}})}function w(a,b,c,e,f){var g=d(f,c[0]),m=c[1];m&&(m=h.parseParsable(m));z[e][h.uid()]=K.create({$elem:b,action:a});b.on(a,function(a){a.preventDefault();switch(m){case "@event":g.react(b,a);break;default:g.react(b,m)}})}function q(b,f,g,m){switch(f.bindingType){case "content":return s(b,f.bindingVals,g,m);case "action":var k=f.bindingVals;switch(b[0].nodeName.toLowerCase()){case "input":f=b.attr("type");switch(f){case "submit":f="click";break;case "text":f="keyup";break;case "password":f="keyup";break;default:f="change"}break;case "form":f="submit";break;default:f="click"}return w(f,b,k,g,m);case "each":var k=f.bindingVals,l;if(1<k.length)throw Error("Iterations can only be bound to a single property.");k=d(m,k[0]);if(":list"!==k.createType)throw Error("Iterations can only be bound to list data.");f=h.uid();l=u(document.createElement("script")).attr("id",f).attr("type","text/Arch-placeholder");h.ownsProp(G,g)&&b.attr("data-arch-permanent","true");b.before(l);b.remove();a(k,b,f,l,g,m);return;case "showIf":return c(!0,b,f.bindingVals,g,m);case "hideIf":return c(!1,b,f.bindingVals,g,m);case "render":g=f.bindingVals;g[1]&&(k=h._getModule(t,g[1]),k._execute(t));b.html(h._templateSource(t,g[0]));g[1]?y(g[0],k._data(t),b,!1,!1):y(g[0],m,b,!1,!1);return;default:if(v.test(f.bindingType))return e(f.bindingType.replace(v,"").toLowerCase(),b,f.bindingVals,g,m);if(I.test(f.bindingType))return w(f.bindingType.replace(I,"").toLowerCase(),b,f.bindingVals,g,m)}throw Error("<"+f.bindingType+"> is not a valid binding type.");}function y(a,b,c,e,f){var g,k;h.uid();z[a]&&!f&&r(a);g=u("[data-bind]",c[0]);!0===e&&c.first().is("[data-bind]")&&(g=c.first().add(g));z[a]=z[a]||{};h.compArr(g,function(c){var e,g,n,I;e=c.getAttribute("data-bind");H.test(e)&&(e=D[e]);f&&(e=e.replace(m,""));g=l(e);n=h.findProperty(g,"bindingType","each");I=a+"/"+h.uid();n=n.length?d(b,n[0].bindingVals[0]):null;p(g);n&&(x.unshift(n.val()),E.unshift(0),k=!0);h.compArr(g,function(e){q(u(c),e,a,b)});D[I]=e;c.setAttribute("data-bind",I)});k&&(x.shift(),E.shift())}var u=n.jQuery,h=n.Arch,t=h.adminKey,z={},B={},D={},G={},C=/^(\d|\.)+$/,H=/(^|\/)Arch\-\d/,v=/Attr$/,I=/Action$/,P=/\//,M=/\..+$/,Q=/^\@each/,m=/(^|\b)each\s*\:\s*[^\;]+(\;|$)/,A=/^(input|textarea|select|option)$/,x=[],E=[],N={content:["render"],render:["content","action"],action:["render"]},K;K=h.Object.extend({_isJQBinding:function(a){if(h._checkAdminKey(t,a,"JQBinding._isJQBinding"))return!0}});h._dataBind=function(a,b){if(h._checkAdminKey(t,a,"_dataBind"))return y(b.viewName,b.context,b.viewSrc,!1,!1)};h._destroyBindings=function(a,b){if(h._checkAdminKey(t,a,"_destroyBindings"))return r(b,!0)};h._registerPermanent=function(a,b){h._checkAdminKey(t,a,"_registerPermanent")&&(G[b]=!0)}})(this);(function(n){var d=n.Arch,r={};d.reactor({id:":errors",wait:!0});d.attempt=function(k,l,p){try{return l.call(p||null)}catch(g){g.timeStamp=(new Date).getTime(),r[k]=r[k]||d.reactor({id:":errors."+k,wait:!0}),r[k].react(g)}}})(this);(function(n){function d(){k.forEach(function(d){d[0].apply(d[2],d[1])});k=[];l=!1}var r=n.Arch,k=[],l=!1;r.queue=function(p,g,b){k.push([p,g||[],b||null]);l||(l=!0,n.setTimeout(function(){d()},0))};r.curry=function(d){var g=Array.prototype.slice.call(arguments,1),b=this;return function(){var a=Array.prototype.slice.call(arguments||[]);return d.apply(b,g.concat(a))}}})(this);(function(n){function d(d){return l.shape.isCollection(d)?JSON.stringify(d):String(d)}function r(d){var b,a;b=d.slice(0,d.indexOf("="));d=d.slice(d.indexOf("=")+1);d=l.parseParsable(d);p.arrItem.test(b)?(a=b.slice(0,b.indexOf("[")),this.newObject[a]||(this.newObject[a]=[]),this.newObject[a].push(d)):p.objItem.test(b)?(a=b.slice(0,b.indexOf("{")),b=b.slice(b.indexOf("{")+1,b.length-1),this.newObject[a]||(this.newObject[a]={}),this.newObject[a][b]=d):this.newObject[b]=d}function k(g,b){var a=l.shape(g);return"array"===a?l.compArr(g,function(a){return"&"+b+"[]="+d(a)}).join(""):"object"===a?l.compArr(g,function(a,c){return"&"+b+"{"+c+"}="+d(a)}).join(""):"&"+b+"="+d(g)}var l=n.Arch,p={arrItem:/[^\[]+\[\]/,objItem:/[^\{]+\{[^\}]+\}/,bookEnds:/^\/|\/$/g};l.parseQS=function(d){var b,a;d||(d=n.location.href);if(-1<d.indexOf("?"))d=n.decodeURI(d.slice(d.indexOf("?")+1));else return{};b=d.lastIndexOf("#");-1!==b&&(a=d.charAt(b-1),d.charAt(b+1),'"'!==a&&"'"!==a&&(d=d.slice(0,b).replace(p.bookEnds,"")));d=d.split("&");l.compArr.call({newObject:{}},d,r);return{}};l.buildQS=function(d,b){var a;a="?"+l.rest(l.listify(d,k).join(""));return b&&(b.prefix&&(a=b.prefix+a),!1===b.encodeURI)?a:n.encodeURI(a)}})(this);(function(n){function d(a){return n.encodeURIComponent(a)}function r(a){if("string"===typeof a)try{return JSON.parse(a)}catch(b){return a}else return a}function k(a){a=localStorage.getItem(f+":"+d(a));a=n.decodeURIComponent(a);return r(a)}function l(a,b){var c=d("string"===typeof b?b:JSON.stringify(b));return localStorage.setItem(f+":"+d(a),c)}function p(a){a=f+":"+d(a);return localStorage.removeItem(a)}function g(a){var b=n.document.cookie.split(";"),c=f+":"+d(a),g;s.compArr(b,function(a){a=a.split("=");if(a[0]===c)return g=r(n.decodeURIComponent(a[1])),s.loops.kill()});return g}function b(a,b){var c=d("string"===typeof b?b:JSON.stringify(b));return document.cookie=f+":"+d(a)+"="+c}function a(a){a=f+":"+d(a);return document.cookie=a+"=null; expires=Thu, 01 Jan 1970 00:00:00 GMT"}var s=n.Arch,c=void 0!==n.localStorage,f=n.encodeURIComponent(n.location.host);s.setLocalItem=c?l:b;s.getLocalItem=c?k:g;s.rmLocalItem=c?p:a;s.setCookie=function(a,c){return b("_Arch_cookie_"+a,c)};s.getCookie=function(a){return g("_Arch_cookie_"+a)};s.rmCookie=function(b){return a("_Arch_cookie_"+b)}})(this);(function(n){function d(d,p){if(r.ownsProp(k,d))throw Error("A transition called "+d+" already exists.");k[d]=p}var r=n.Arch,k={};d(":default",function(d){r.animate(d.changingArchlets,{opacity:0},{queue:!1,wait:!0,duration:d.speed/2,complete:function(){d.preRender();d.render();d.postRender();r.animate(d.changingArchlets,{opacity:1},{queue:!1,duration:d.speed/2})}})});r.addRouteTransition=d;r._accessTransitions=function(d){if(r._checkAdminKey(r.adminKey,d,"_getTransitions"))return k}})(this);(function(n){function d(a){return a.replace(/\s+/g," ").trim().split(" ")}function r(a){v[a]=v[a]||{name:a,outlets:{},cons:{},speed:150,transType:":default",bindings:{},$outlets:u(),commonEnter:null,commonExit:null,commonPreRender:null,defaultCon:null,curState:null}}function k(a){if(null===a)throw Error("Arch tried to route to a null path. This usually happens when a default route has not been specified.");return"/"+a.replace(/^\/+|\/?(\?.+)?$/g,"")}function l(a){var b=v[a.appName],c;if(!b.curState)return b.$outlets;c=u();h.compArr(b.$outlets,function(a){var e=d(a.getAttribute("role"));h.ownsProp(b.bindings,1===e.length?e[0]:e[1])||(c=c.add(a))});return c}function p(a,b){h.compArr(a.attributes,function(a){"to"!==a.name.toLowerCase()&&b.setAttribute(a.name,a.value)})}function g(a){var b=u("bind",a);b.length&&(h.compArr(b,function(a){var b=u(a),c=document.createElement("span");if(b.prop("data-bind"))throw Error("The <bind> node can not take the data-bind attribute.");c.setAttribute("data-bind","content: "+a.getAttribute("to"));b.replaceWith(c)}),g(a))}function b(a){var c=u("bindlist",a);c.length&&(h.compArr(c,function(a){var b=u(a),c=a.innerHTML,e=a.getAttribute("to"),d="string"===typeof a.getAttribute("ordered")?"ol":"ul",d=document.createElement(d);if(b.prop("data-bind"))throw Error("The <bindlist> node can not take the data-bind attribute.");p(a,d);b.replaceWith(d);d.innerHTML='<li data-bind="each:'+e+'">'+c+"</li>"}),b(a))}function a(a,b){a.html(b.replace(/\{\{([^\}]+)\}\}/g,'<span data-bind="content: $1"></span>'))}function s(a,b,c,e){return function(){var d=e,d=v[c.appName],f=d.cons[a],g=f.hash,k=d.curState;d.curState=a;d===C&&f.usesHash&&(n.location.hash=g);d.$outlets.attr("data-arch-current",a);"string"===typeof f.autoStore&&h._getStores(t,d.appName)[f.autoStore].attach();c._execute(t);d.commonPreRender&&d.commonPreRender(k,a,b);f._onPreRender&&f._onPreRender(t)(b)}}function c(c,e,d,f){return function(){h.listify(c.outlets,function(k,l){h.ownsProp(c.bindings,l)?(c.bindings[l][0]._execute(t),""===k.html()&&(h._registerPermanent(t,c.bindings[l][1].name),a(k,c.bindings[l][1].content),!0!==D&&(g(k),b(k)),h._dataBind(t,{viewName:l,context:c.bindings[l][0]._data(t),viewSrc:k}))):(d&&h._destroyBindings(t,d.name),a(k,e.content),!0!==D&&(g(k),b(k)),h._dataBind(t,{viewName:e.name,context:f._data(t),viewSrc:k}))})}}function f(a,b,c,e){return function(){var d=v[e.appName],f=d.cons[b];e._receive(t).react(c);d.commonEnter&&d.commonEnter(a,b,c);f._onEnter&&f._onEnter(t)(c);u("html, body").animate({scrollTop:e.scroll},{queue:!1,duration:0})}}function e(a,b,e,d){var g,q,p,n,r,w;g=e.cons[a];q=g.module;p=g.template;r=(n=!e.curState)?null:e.cons[e.curState].template;w=e.curState;d=B[d||g.transition||e.transType];if(n){b=k(location.hash);/\?/.test(location.href)?(n=h.parseQS(location.href,{parseBool:!0,paresNum:!0}),h.setLocalItem("_Arch:queryStringReload",n),b=location.href.replace(/\?.*$/,"").replace(/\#.*$/,"").replace(/\/*$/,"")+b,location.href=b,b=!0):b=void 0;if(b)return;b=h.getLocalItem("_Arch:queryStringReload");h.rmLocalItem("_Arch:queryStringReload");b=b||void 0}if(a!==e.curState){n=b;g=v[q.appName];var u;g.curState&&(u=g.cons[g.curState],"string"===typeof u.autoStore&&h._getStores(t,g.appName)[u.autoStore].detach(),g.commonExit&&g.commonExit(g.curState,a,n),g.cons[g.curState]._onExit&&g.cons[g.curState]._onExit(t)(a,n));n=l(q);return d({preRender:s(a,b,q,e),render:c(e,p,r,q),postRender:f(w,a,b,q),changingArchlets:n,speed:e.speed})}}function w(a,b,c){var d=this.appName;if(!v[d])throw Error("This module is not directly associated with an app and may not call Module.route.");return e(a,b,v[d],c)}function q(){var a=u("archlet").css("display","block");$outlets=a;h.compArr(a,function(a){var b=d(a.getAttribute("role"));1===b.length&&b.unshift(z);r(b[0]);v[b[0]].$outlets.push(a);v[b[0]].outlets[b[1]]=u(a)})}function y(){u(window).on("scroll",function(){var a;G?(a=u(window).scrollTop(),h.listify(v,function(b){b.cons[b.curState].module.scroll=a})):G=!0})}var u=n.jQuery,h=n.Arch,t=h.adminKey,z=h._getFallbackName(t),B=h._accessTransitions(t),D=h._getConfig(t,"disableCustomTags"),G=!0,C,H,v={};h.system.ready=h.reactor({id:h._getSystemID(t)+"._system/ready",wait:!0});H=h.Object.extend({enter:function(a){if(this._onEnter)throw Error("The <enter> function has already been set for this connection.");this._onEnter=function(b){if(h._checkAdminKey(t,b,"_onEnter"))return a};return this},exit:function(a){if(this._onExit)throw Error("The <exit> function has already been set for this connection.");this._onExit=function(b){if(h._checkAdminKey(t,b,"_onExit"))return a};return this},preRender:function(a){if(this._onPreRender)throw Error("The <preRender> function has already been set for this connection.");this._onPreRender=function(b){if(h._checkAdminKey(t,b,"_onPreRender"))return a};return this},transitionType:function(a){this.transition=a;return this},useStore:function(a){this.autoStore=a;return this}});r(z);h.currentRoute=function(a){return v[a||z].curState};h.Module._addMethod(t,"route",w);h.RoutesModule._addMethod(t,"route",w);h.RoutesModule._addMethod(t,"connectPath",function(a,b,c,e){var d=this.appName;b=k(b);r(d,this);v[d].cons[a]=H.create({module:c,template:e,name:a,hash:b,usesHash:!0});if(!C)C=v[d];else if(C!==v[d])throw Error("You can only have one app that uses hash paths at a time.");return v[d].cons[b]});h.RoutesModule._addMethod(t,"connect",function(a,b,c){var e=this.appName;r(e,this);return v[e].cons[a]=H.create({module:b,template:c,name:a,usesHash:!1})});h.RoutesModule._addMethod(t,"defaultRoute",function(a){var b=this.appName;r(b);if(v[b].defaultCon)throw Error("A default route has already been specified for this app.");v[b].defaultCon=a});h.RoutesModule._addMethod(t,"speed",function(a){var b=this.appName;r(b);v[b].speed=a});h.RoutesModule._addMethod(t,"transitions",function(a){var b=this.appName;r(b);v[b].transType=a});h.RoutesModule._addMethod(t,"enter",function(a){var b=this.appName;r(b);v[b].commonEnter=a});h.RoutesModule._addMethod(t,"exit",function(a){var b=this.appName;r(b);v[b].commonExit=a});h.RoutesModule._addMethod(t,"preRender",function(a){var b=this.appName;r(b);v[b].commonPreRender=a});h.RoutesModule._addMethod(t,"bindArchlet",function(a,b,c){var e=this.appName;r(e);v[e].bindings[a]=[b,c]});n.onhashchange=function(a){var b=k(n.location.hash.replace(/^\#/,""));a.preventDefault();h.listify(C.cons,function(a){if(a.usesHash&&a.hash===b)return G=!1,e(a.name,void 0,C),h.loops.kill()})};u(function(){var a=k(n.location.hash.replace(/^\#/,"")),b=!1;q();h.system.execRoutes.react(!0);y();h.listify(v,function(c,d){if(c.$outlets.length)return c===C?(h.listify(c.cons,function(d){if(d.usesHash&&d.hash===a)return b=!0,e(d.name,void 0,c),h.loops.kill()}),b?b:e(c.defaultCon,void 0,c)):e(c.defaultCon,void 0,c)});h.system.ready.react(!0)})})(this);(function(n){function d(a,d,e){var g="",k,l;a=a.replace(b,e);k=a.length;for(l=0;l<k;l+=1)g=0===l?a[l]===d||a[l]===e?g+"":g+a[0]:p.test(a[l])?g+(e+a[l].toLowerCase()):a[l]===d?g+e:g+a[l];return g}function r(a,b,e,d){var g=a.match(b);e=e||"";d=d||-1;return g?r(a.slice(g.index+g[0].length),b,e+a.slice(0,g.index)+g[0],e.length+g.index):e?d:-1}var k=n.Arch,l=/(^|\s|\-|\_)([a-z])/,p=/[A-Z]/,g=/[a-z]/,b=/[\-\_\s]+/g,a=/^[\-\_]/,s=/^(.*)\~(\d+)(.*)$/;k.reverseStr=function(a){return a.split("").reverse().join("")};k.indexOfMatch=function(a,b){var e=a.match(b);return e?e.index:-1};k.lastIndexOfMatch=function(a,b){return r(a,b,"")};k.multiplyStr=function(a,b){var e,d="";for(e=0;e<b;e+=1)d+=a;return d};k.capitalize=function(a){return a[0].toUpperCase()+a.slice(1)};k.titleize=function(a){var b=a.match(l),e,d;if(!b)return a;d=b[0];e=b[2];b=b.index;return k.titleize(a.slice(0,b)+k.lead(d)+e.toUpperCase()+a.slice(b+d.length))};k.dasherize=function(a){return d(a,"_","-")};k.underscore=function(a){return d(a,"-","_")};k.spacify=function(a){return k.underscore(a).replace(/\_/g," ")};k.camelize=function(c,d){var e="",k,l;c=c.replace(b,"_").replace(a,"");k=c.length;for(l=0;l<k;l+=1)0===l?e=g.test(c[l])&&!0===d?e+c[l].toUpperCase():e+c[l]:"_"===c[l]?(e+=c[l+1].toUpperCase(),l+=1):e+=c[l];return e};k.format=function(a,b){var d=a.match(s);return d?k.format(d[1]+b[parseInt(d[2])]+d[3],b):a}})(this);